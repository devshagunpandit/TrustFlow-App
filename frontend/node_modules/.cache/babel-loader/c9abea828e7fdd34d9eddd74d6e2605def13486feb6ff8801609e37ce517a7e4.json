{"ast":null,"code":"var _jsxFileName = \"/workspaces/TrustFlow-App/frontend/src/pages/AuthCallback.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '@/lib/supabase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthCallback = () => {\n  _s();\n  const navigate = useNavigate();\n  const [status, setStatus] = useState('Verifying...');\n  useEffect(() => {\n    const handleAuth = async () => {\n      // 1. Manually parse the URL hash to find the token\n      const hash = window.location.hash;\n\n      // Debug log (check console if stuck)\n      console.log(\"Auth Callback Hash:\", hash);\n      if (hash && hash.includes('access_token')) {\n        try {\n          // Extract the token manually\n          const params = new URLSearchParams(hash.substring(1)); // remove the '#'\n          const accessToken = params.get('access_token');\n          const refreshToken = params.get('refresh_token');\n          if (!accessToken) {\n            setStatus('No access token found.');\n            return;\n          }\n\n          // 2. Force Supabase to set the session\n          const {\n            data,\n            error\n          } = await supabase.auth.setSession({\n            access_token: accessToken,\n            refresh_token: refreshToken || ''\n          });\n          if (error) {\n            console.error(\"Supabase Error:\", error);\n            setStatus('Login failed: ' + error.message);\n            // Fallback: send them to login after 2 seconds\n            setTimeout(() => navigate('/login'), 2000);\n          } else {\n            // Success! Clear hash and go to dashboard\n            console.log(\"Session set successfully\");\n            navigate('/dashboard');\n          }\n        } catch (e) {\n          console.error(\"Manual parsing error\", e);\n          setStatus('Error parsing token.');\n        }\n      } else {\n        // No hash? Maybe they are already logged in?\n        const {\n          data: {\n            session\n          }\n        } = await supabase.auth.getSession();\n        if (session) {\n          navigate('/dashboard');\n        } else {\n          setStatus('No login data found. Redirecting...');\n          setTimeout(() => navigate('/login'), 1500);\n        }\n      }\n    };\n    handleAuth();\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col items-center justify-center min-h-screen bg-slate-50 dark:bg-slate-900\",\n    \"x-file-name\": \"AuthCallback\",\n    \"x-line-number\": \"65\",\n    \"x-component\": \"div\",\n    \"x-id\": \"AuthCallback_65\",\n    \"x-dynamic\": \"false\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-10 h-10 border-4 border-violet-600 border-t-transparent rounded-full animate-spin mb-4\",\n      \"x-file-name\": \"AuthCallback\",\n      \"x-line-number\": \"66\",\n      \"x-component\": \"div\",\n      \"x-id\": \"AuthCallback_66\",\n      \"x-dynamic\": \"false\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl font-semibold\",\n      \"x-file-name\": \"AuthCallback\",\n      \"x-line-number\": \"67\",\n      \"x-component\": \"h2\",\n      \"x-id\": \"AuthCallback_67\",\n      \"x-dynamic\": \"true\",\n      children: status\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-muted-foreground text-sm mt-2\",\n      \"x-file-name\": \"AuthCallback\",\n      \"x-line-number\": \"68\",\n      \"x-component\": \"p\",\n      \"x-id\": \"AuthCallback_68\",\n      \"x-dynamic\": \"false\",\n      children: \"Do not close this window.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthCallback, \"TsTDFSEUPfzeLnrdjUNLvOXU3HM=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthCallback;\nexport default AuthCallback;\nvar _c;\n$RefreshReg$(_c, \"AuthCallback\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","supabase","jsxDEV","_jsxDEV","AuthCallback","_s","navigate","status","setStatus","handleAuth","hash","window","location","console","log","includes","params","URLSearchParams","substring","accessToken","get","refreshToken","data","error","auth","setSession","access_token","refresh_token","message","setTimeout","e","session","getSession","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/workspaces/TrustFlow-App/frontend/src/pages/AuthCallback.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '@/lib/supabase';\n\nconst AuthCallback = () => {\n  const navigate = useNavigate();\n  const [status, setStatus] = useState('Verifying...');\n\n  useEffect(() => {\n    const handleAuth = async () => {\n      // 1. Manually parse the URL hash to find the token\n      const hash = window.location.hash;\n      \n      // Debug log (check console if stuck)\n      console.log(\"Auth Callback Hash:\", hash);\n\n      if (hash && hash.includes('access_token')) {\n        try {\n          // Extract the token manually\n          const params = new URLSearchParams(hash.substring(1)); // remove the '#'\n          const accessToken = params.get('access_token');\n          const refreshToken = params.get('refresh_token');\n\n          if (!accessToken) {\n            setStatus('No access token found.');\n            return;\n          }\n\n          // 2. Force Supabase to set the session\n          const { data, error } = await supabase.auth.setSession({\n            access_token: accessToken,\n            refresh_token: refreshToken || '',\n          });\n\n          if (error) {\n            console.error(\"Supabase Error:\", error);\n            setStatus('Login failed: ' + error.message);\n            // Fallback: send them to login after 2 seconds\n            setTimeout(() => navigate('/login'), 2000);\n          } else {\n            // Success! Clear hash and go to dashboard\n            console.log(\"Session set successfully\");\n            navigate('/dashboard');\n          }\n        } catch (e) {\n          console.error(\"Manual parsing error\", e);\n          setStatus('Error parsing token.');\n        }\n      } else {\n        // No hash? Maybe they are already logged in?\n        const { data: { session } } = await supabase.auth.getSession();\n        if (session) {\n          navigate('/dashboard');\n        } else {\n          setStatus('No login data found. Redirecting...');\n          setTimeout(() => navigate('/login'), 1500);\n        }\n      }\n    };\n\n    handleAuth();\n  }, [navigate]);\n\n  return (\n    <div className=\"flex flex-col items-center justify-center min-h-screen bg-slate-50 dark:bg-slate-900\">\n      <div className=\"w-10 h-10 border-4 border-violet-600 border-t-transparent rounded-full animate-spin mb-4\" />\n      <h2 className=\"text-xl font-semibold\">{status}</h2>\n      <p className=\"text-muted-foreground text-sm mt-2\">Do not close this window.</p>\n    </div>\n  );\n};\n\nexport default AuthCallback;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}